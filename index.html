<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Amigo Bicho</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f4f4f4;
    }
    select, button {
        padding: 12px;
        font-size: 18px;
        margin-top: 10px;
        width: 250px;
    }
    #resultado {
        margin-top: 20px;
        font-size: 22px;
        font-weight: bold;
        padding: 15px;
        background: white;
        border-radius: 10px;
    }
</style>

<!-- Firebase compat (suporta HTML puro) -->
<script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore-compat.js"></script>

</head>
<body>

<h2>Escolha seu nome</h2>

<select id="nomeSelect">
    <option value="">Selecione...</option>
</select>

<br><br>

<button onclick="gerarBicho()">Quero meu bicho</button>

<div id="resultado"></div>

<script>
// =======================
// ðŸ“Œ Firebase compatÃ­vel com HTML puro
// =======================
const firebaseConfig = {
  apiKey: "AIzaSyA0zYMXJSCbZ5G85kW_LZY2RyXMAm0yxm8",
  authDomain: "amigo-bicho.firebaseapp.com",
  projectId: "amigo-bicho",
  storageBucket: "amigo-bicho.firebasestorage.app",
  messagingSenderId: "540631256970",
  appId: "1:540631256970:web:bf3ce03155bffffdbcc273"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();


// =======================
// ðŸ“Œ LISTAS CORRETAS
// =======================
const listaNomes = [
  "Caio", "Lorraine", "Iza", "Dione", "Gabi",
  "Richard", "LetÃ­cia", "Ãtalo", "Emille"
];

const listaBichos = [
  "Anta", "TilÃ¡pia", "Rola", "Panda", "Jumento",
  "Lacraia", "Porco", "Urso", "Urubu"
];


// =======================
// ðŸ“Œ Preencher select
// =======================
const select = document.getElementById("nomeSelect");

listaNomes.forEach(nome => {
    const opt = document.createElement("option");
    opt.value = nome;
    opt.textContent = nome;
    select.appendChild(opt);
});


// =======================
// ðŸ“Œ BLOQUEIO POR DISPOSITIVO
// =======================
function dispositivoJaUsou() {
    return localStorage.getItem("bloqueado") === "1";
}

function bloquearDispositivo() {
    localStorage.setItem("bloqueado", "1");
}


// =======================
// ðŸ“Œ FUNÃ‡ÃƒO PRINCIPAL
// =======================
async function gerarBicho() {
    const nome = select.value;
    const resultado = document.getElementById("resultado");

    if (!nome) {
        resultado.textContent = "Selecione seu nome!";
        return;
    }

    // Bloqueio: dispositivo sÃ³ pode usar 1 vez
    if (dispositivoJaUsou()) {
        resultado.textContent = "Este dispositivo jÃ¡ gerou um bicho e nÃ£o pode gerar outro!";
        return;
    }

    // Verificar se nome jÃ¡ tem bicho
    const ref = db.collection("bichos").doc(nome);
    const snap = await ref.get();

    if (snap.exists) {
        const bicho = snap.data().bicho;
        resultado.textContent = `${nome}, seu bicho Ã©: ${bicho}`;
        bloquearDispositivo();
        return;
    }

    // Sortear bicho
    const bichoSorteado = listaBichos[Math.floor(Math.random() * listaBichos.length)];

    // Salvar no Firebase
    await ref.set({ bicho: bichoSorteado });

    resultado.textContent = `${nome}, seu bicho Ã©: ${bichoSorteado}`;

    bloquearDispositivo();
}

</script>

</body>
</html>
